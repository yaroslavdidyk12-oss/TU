<!DOCTYPE html>
<html lang="uk">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1b1b1b">
<link rel="apple-touch-icon" href="icon-192.png">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢–∞–∫—Ç–∏—á–Ω–∏–π —É—Ä–±–∞–Ω—ñ—Å—Ç</title>
<style>
body{margin:0;font-family:Arial;background:#1b1b1b;color:#fff}
.board{max-width:420px;margin:auto;padding:15px}
h2{text-align:center;margin-bottom:10px}
.row{display:flex;justify-content:space-between;align-items:center;background:#2d2d2d;padding:8px;border-radius:6px;margin-bottom:6px}
button{border:none;border-radius:6px;padding:8px;color:#fff;background:#555}
button:disabled{opacity:.4}
.full{width:100%}
.green{background:#2e8b57}
.red{background:#8b2e2e}
.orange{background:#b36b00}
.blue{background:#2e5b8b}
select{background:#444;color:#fff;border:none;border-radius:6px;padding:4px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;align-items:center;justify-content:center}
.modalBox{background:#2b2b2b;padding:16px;border-radius:10px;width:85%;text-align:center}
</style>
</head>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
</script>
<body>
<div class="board">
<h2>üèô –¢–∞–∫—Ç–∏—á–Ω–∏–π —É—Ä–±–∞–Ω—ñ—Å—Ç</h2>

<div class="row">
<span>–ì—Ä–∞–≤—Ü—ñ–≤</span>
<select id="players" onchange="setupPlayers()">
<option>1</option><option>2</option><option>3</option>
<option>4</option><option>5</option><option>6</option>
</select>
</div>

<div class="row">
<span>–Ø –≥—Ä–∞–≤–µ—Ü—å ‚Ññ</span>
<select id="you"></select>
</div>

<div class="row">‚ö° –ï–Ω–µ—Ä–≥—ñ—è: <b id="energy"></b></div>
<div class="row">üè≠ –ü—Ä–æ–º–∏—Å–ª–æ–≤—ñ—Å—Ç—å: <b id="industry"></b></div>
<div class="row">‚öîÔ∏è –í—ñ–π—Å—å–∫–æ: <b id="army"></b></div>
<div class="row">üõ° –û–±–æ—Ä–æ–Ω–∞: <b id="defense"></b></div>
<div class="row"><b id="phase"></b></div>

<div class="row">
<button class="blue full" onclick="build('industry',1)">–ë—É–¥—É–≤–∞—Ç–∏ üè≠  1‚ö°</button>
<button class="red full" onclick="build('army',5)">–ë—É–¥—É–≤–∞—Ç–∏ ‚öîÔ∏è  5‚ö°</button>
<button class="green full" onclick="build('defense',4)">–ë—É–¥—É–≤–∞—Ç–∏ üõ° 4‚ö°</button>
</div>
<div class="row">
<button class="orange full" onclick="drawCard()">üé≤ –ö–∞—Ä—Ç–∞ –ø–æ–¥—ñ—ó</button>
</div>
<div class="row">
<button class="blue full" onclick="nextTurn()">‚è≠ –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ö—ñ–¥</button>
</div>
<div class="row"><span>–°–∏–º—É–ª—è—Ü—ñ—è –¥—ñ–π —Å—É—Å—ñ–¥–∞:</span></div>
<div class="row">
<button class="orange full" onclick="neighborSpy()">üïµÔ∏è –°—É—Å—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –®–ø–∏–≥—É–Ω</button>
</div>
<div class="row">
<button class="orange full" onclick="neighborAdmiral()">‚öì –°—É—Å—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ê–¥–º—ñ—Ä–∞–ª–∞</button>
</div>
<div class="row">
<button class="red full" onclick="resetGame()">üîÅ –ü–æ—á–∞—Ç–∏ –∑ –ø–æ—á–∞—Ç–∫—É</button>
</div>


<div class="modal" id="modal">
<div class="modalBox">
<p id="modalText"></p>
<button class="green full" id="yesBtn" onclick="modalYes()">–¢–ê–ö</button>
<button class="red full" id="noBtn" onclick="modalNo()">–ù–Ü</button>
<button class="full" id="okBtn" onclick="modalOk()">OK</button>
</div>
</div>

<script>
let energy,industry,army,defense,phase;
let pendingAction=null;
let deck=[],discard=[];
let players=1, you=1, turn=0;
let cardsDrawn=0,maxCards=20;

function setupPlayers(){
 players = parseInt(document.getElementById("players").value);
 const youSel = document.getElementById("you");
 youSel.innerHTML="";
 for(let i=1;i<=players;i++){
   const o=document.createElement("option");
   o.value=i; o.text=i;
   youSel.appendChild(o);
 }
 resetGame();
}

function buildDeck(){
 deck=[]; discard=[]; cardsDrawn=0;
 let config={spy:3, admiral:2, disaster:5, crisis:4, sabotage:6};
 for(let k in config) for(let i=0;i<config[k];i++) deck.push(k);
 shuffle(deck);
}

function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}

function drawFromDeck(){if(cardsDrawn>=maxCards || deck.length===0) return null; const c=deck.pop(); discard.push(c); cardsDrawn++; return c;}

function resetGame(){
 you = parseInt(document.getElementById("you").value || 1);
 energy=1; industry=0; army=0; defense=0; phase=0; turn=0;
 buildDeck(); update();
}

function update(){
 if(energy>8) energy=8;
 if(energy===0 && industry===0) energy=1;
 industry=Math.max(0,industry);
 army=Math.max(0,army);
 defense=Math.max(0,defense);
 document.getElementById("energy").innerText=energy;
 document.getElementById("industry").innerText=industry;
 document.getElementById("army").innerText=army;
 document.getElementById("defense").innerText=defense;
 document.getElementById("phase").innerText=phase===0?"–§–∞–∑–∞: –∫–∞—Ä—Ç–∞ –ø–æ–¥—ñ—ó":"–§–∞–∑–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞";
}

function isYourTurn(){return players===1 || (turn%players)===(you-1);}

function showModal(text,mode,action){
 document.getElementById("modalText").innerText=text; pendingAction=action; 
 document.getElementById("yesBtn").style.display=mode==="choice"?"block":"none";
 document.getElementById("noBtn").style.display=mode==="choice"?"block":"none";
 document.getElementById("okBtn").style.display=mode==="info"?"block":"none";
 document.getElementById("modal").style.display="flex";
}

function modalYes(){if(pendingAction)pendingAction(); closeModal();}
function modalNo(){closeModal();}
function modalOk(){closeModal();}
function closeModal(){pendingAction=null; document.getElementById("modal").style.display="none"; phase=1; update();}

function drawCard(){
 if(phase!==0) return;

 if(!isYourTurn()){showModal("–•—ñ–¥ —ñ–Ω—à–æ–≥–æ –≥—Ä–∞–≤—Ü—è ‚Äî –∫–∞—Ä—Ç–∞ –Ω–∞ –≤–∞—Å –Ω–µ –¥—ñ—î","info"); phase=1; update(); return;}

 const type = drawFromDeck();
 if(!type){showModal("–í—Å—ñ –∫–∞—Ä—Ç–∏ –≤–∏—Ç—Ä–∞—á–µ–Ω—ñ","info"); return;}

if(type==="spy"){
   showModal("üïµÔ∏è –®–ø–∏–≥—É–Ω\n–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —ñ–Ω—à–æ–≥–æ –≥—Ä–∞–≤—Ü—è –∑–∞ 2 –µ–Ω–µ—Ä–≥—ñ—ó?","choice",
     ()=>{
       if(energy>=2){
           energy-=2;
           showModal("üïµÔ∏è –®–ø–∏–≥—É–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ø—Ä–æ—Ç–∏ —Å—É—Å—ñ–¥–∞","info");
       } else {
           showModal("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –µ–Ω–µ—Ä–≥—ñ—ó","info");
       }
   });

} else if(type==="admiral"){

   showModal("‚öì –ê–¥–º—ñ—Ä–∞–ª\n–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —ñ–Ω—à–æ–≥–æ –≥—Ä–∞–≤—Ü—è –∑–∞ 6 –µ–Ω–µ—Ä–≥—ñ—ó?","choice",
     ()=>{
       if(energy>=6){
           energy-=6;
           showModal("‚öì –ê–¥–º—ñ—Ä–∞–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ø—Ä–æ—Ç–∏ —Å—É—Å—ñ–¥–∞","info");
       } else {
           showModal("–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –µ–Ω–µ—Ä–≥—ñ—ó","info");
       }
   });

 } else if(type==="disaster"){
   if(industry>0) industry--; showModal("üå™ –°—Ç–∏—Ö—ñ–π–Ω–µ –ª–∏—Ö–æ ‚Äî –≤—Ç—Ä–∞—á–µ–Ω–æ 1 –ø—Ä–æ–º–∏—Å–ª–æ–≤—ñ—Å—Ç—å","info");
 } else if(type==="crisis"){
   energy=0; showModal("üìâ –ï–∫–æ–Ω–æ–º—ñ—á–Ω–∞ –∫—Ä–∏–∑–∞ ‚Äî –≤—Å—è –µ–Ω–µ—Ä–≥—ñ—è –≤—Ç—Ä–∞—á–µ–Ω–∞","info");
 } else if(type==="sabotage"){
   if(defense>0){defense--; showModal("üí£ –î–∏–≤–µ—Ä—Å—ñ—è ‚Äî –≤—Ç—Ä–∞—á–µ–Ω–æ 1 –æ–±–æ—Ä–æ–Ω—É","info");}
   else{let lost=Math.min(2,industry); if(lost>=industry && energy===0 && industry-lost===0) lost=industry-1; if(lost<0) lost=0; industry-=lost; showModal(`üí£ –î–∏–≤–µ—Ä—Å—ñ—è ‚Äî –≤—Ç—Ä–∞—á–µ–Ω–æ ${lost} –ø—Ä–æ–º–∏—Å–ª–æ–≤—ñ—Å—Ç—å`,"info");}}
 phase=1; update();
}

function build(type,cost){
 if(phase!==1 || energy<cost) return;
 energy-=cost;
 if(type==="industry")industry++;
 if(type==="army")army++;
 if(type==="defense")defense++;
 update();
}

function nextTurn(){if(phase!==1) return; energy+=industry; if(energy>8) energy=8; turn++; phase=0; update();}

// –°–∏–º—É–ª—è—Ü—ñ—è –¥—ñ–π —Å—É—Å—ñ–¥–∞
function neighborSpy(){
 if(defense>0) defense--;
 else{
     if(energy>=1) industry = Math.max(0, industry-2);
     else industry = Math.max(1, industry-2);
 }
 showModal("üïµÔ∏è –°—É—Å—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ –®–ø–∏–≥—É–Ω","info"); update();
}

function neighborAdmiral(){
 if(army>0) army--;
 else{
     if(energy>=1) industry = Math.max(0, industry-2);
     else industry = Math.max(1, industry-2);
 }
 showModal("‚öì –°—É—Å—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ –ê–¥–º—ñ—Ä–∞–ª–∞","info"); update();
}

setupPlayers();
</script>
</body>
</html>

